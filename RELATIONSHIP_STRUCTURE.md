# 关系图文件结构说明

## 文件夹结构

关系图数据存储在每本书的 `relationships` 文件夹中，结构如下：

```
books/
├── 书名1/
│   ├── relationships/
│   │   ├── 关系图1.png      # 关系图缩略图
│   │   ├── 关系图1.json     # 关系图数据
│   │   ├── 关系图2.png
│   │   ├── 关系图2.json
│   │   └── ...
│   └── ...
└── 书名2/
    ├── relationships/
    │   ├── 关系图A.png
    │   ├── 关系图A.json
    │   └── ...
    └── ...
```

## 文件命名规则

- **图片文件**: `关系图名称.png` - 关系图的缩略图或完整图片
- **数据文件**: `关系图名称.json` - 关系图的完整数据，包含节点、连线等信息

## JSON 数据结构

```json
{
  "id": "唯一标识符",
  "name": "关系图名称",
  "description": "关系图描述",
  "thumbnail": "base64编码的缩略图数据",
  "nodes": [
    {
      "id": "节点ID",
      "name": "节点名称",
      "type": "节点类型(character/location/event/item)",
      "description": "节点描述",
      "x": 100,
      "y": 200
    }
  ],
  "edges": [
    {
      "id": "连线ID",
      "source": "起始节点ID",
      "target": "目标节点ID",
      "type": "关系类型",
      "description": "关系描述"
    }
  ],
  "createdAt": "创建时间",
  "updatedAt": "更新时间"
}
```

## 节点类型说明

- `character`: 人物节点
- `location`: 地点节点
- `event`: 事件节点
- `item`: 物品节点

## 功能特性

1. **列表展示**: 显示所有关系图的缩略图和名称
2. **创建功能**: 创建新的关系图，自动生成空白缩略图
3. **编辑功能**: 进入关系图编辑页面进行详细编辑
4. **删除功能**: 删除关系图及其相关文件
5. **数据同步**: 自动保存和加载关系图数据

## 文件操作

- **创建**: 同时创建 `.png` 和 `.json` 文件
- **读取**: 从 `.json` 文件读取数据，从 `.png` 文件读取缩略图
- **更新**: 更新 `.json` 文件数据，可选择更新 `.png` 文件
- **删除**: 同时删除 `.png` 和 `.json` 文件 
# 关系图功能测试文档

## 测试环境
- Electron 应用
- Vue 3 + Element Plus
- relation-graph-vue3 插件

## 测试步骤

### 1. 基础功能测试

#### 1.1 关系图列表页测试
- [ ] 点击编辑器工具栏的"关系图"按钮
- [ ] 验证跳转到关系图列表页
- [ ] 验证页面显示"关系图列表"标题
- [ ] 验证"创建关系图"按钮存在

#### 1.2 创建关系图测试
- [ ] 点击"创建关系图"按钮
- [ ] 输入关系图名称（如：测试关系图）
- [ ] 输入关系图描述（如：这是一个测试关系图）
- [ ] 点击"创建"按钮
- [ ] 验证创建成功提示
- [ ] 验证跳转到关系图编辑页

#### 1.3 关系图编辑页测试
- [ ] 验证页面显示"关系图编辑"标题
- [ ] 验证工具栏包含"添加节点"、"添加连线"、"清空画布"按钮
- [ ] 验证画布区域显示关系图组件

### 2. 节点管理测试

#### 2.1 添加人物节点
- [ ] 点击"添加节点"按钮
- [ ] 选择"人物"类型
- [ ] 从下拉列表中选择一个人物
- [ ] 点击"确认"按钮
- [ ] 验证节点在画布上显示
- [ ] 验证节点颜色为蓝色（人物类型）

#### 2.2 添加自定义节点
- [ ] 点击"添加节点"按钮
- [ ] 选择"自定义"类型
- [ ] 输入节点名称（如：重要地点）
- [ ] 选择节点类型（如：地点）
- [ ] 输入节点描述
- [ ] 点击"确认"按钮
- [ ] 验证节点在画布上显示
- [ ] 验证节点颜色为绿色（地点类型）

#### 2.3 节点详情查看
- [ ] 点击画布上的节点
- [ ] 验证弹出节点详情对话框
- [ ] 验证显示节点名称、类型、描述等信息
- [ ] 验证"删除节点"按钮存在

#### 2.4 删除节点
- [ ] 在节点详情对话框中点击"删除节点"
- [ ] 确认删除操作
- [ ] 验证节点从画布上消失
- [ ] 验证相关连线也被删除

### 3. 连线管理测试

#### 3.1 添加连线
- [ ] 确保画布上有至少两个节点
- [ ] 点击"添加连线"按钮
- [ ] 选择起始节点
- [ ] 选择目标节点
- [ ] 输入关系类型（如：朋友）
- [ ] 输入关系描述
- [ ] 点击"确认"按钮
- [ ] 验证连线在画布上显示

#### 3.2 连线验证
- [ ] 尝试选择相同的起始节点和目标节点
- [ ] 验证显示警告信息
- [ ] 尝试添加已存在的连线
- [ ] 验证显示警告信息

### 4. 数据保存测试

#### 4.1 保存关系图
- [ ] 在编辑页面进行一些修改（添加节点、连线）
- [ ] 点击"保存"按钮
- [ ] 验证保存成功提示
- [ ] 验证数据持久化

#### 4.2 数据加载测试
- [ ] 关闭编辑页面
- [ ] 重新打开关系图
- [ ] 验证之前的数据正确加载

### 5. 缩略图生成测试

#### 5.1 自动缩略图生成
- [ ] 创建关系图后返回列表页
- [ ] 验证关系图卡片显示缩略图
- [ ] 验证缩略图包含节点和连线信息

#### 5.2 缩略图更新
- [ ] 编辑关系图，添加或删除节点
- [ ] 保存关系图
- [ ] 返回列表页
- [ ] 验证缩略图已更新

### 6. 文件系统测试

#### 6.1 文件创建
- [ ] 创建关系图后检查文件系统
- [ ] 验证在 `books/书名/relationships/` 目录下创建了 `.json` 和 `.png` 文件
- [ ] 验证文件名与关系图名称一致

#### 6.2 文件删除
- [ ] 在列表页右键点击关系图
- [ ] 选择"删除"
- [ ] 确认删除操作
- [ ] 验证 `.json` 和 `.png` 文件都被删除

### 7. 错误处理测试

#### 7.1 网络错误处理
- [ ] 模拟文件系统错误
- [ ] 验证错误信息正确显示
- [ ] 验证应用不会崩溃

#### 7.2 数据验证
- [ ] 尝试创建同名关系图
- [ ] 验证显示错误提示
- [ ] 尝试保存无效数据
- [ ] 验证表单验证正常工作

## 预期结果

### 成功标准
1. 所有功能按钮正常工作
2. 数据正确保存和加载
3. 缩略图正确生成和更新
4. 文件系统操作正常
5. 错误处理机制完善
6. 用户界面响应流畅

### 性能要求
1. 页面加载时间 < 2秒
2. 保存操作响应时间 < 1秒
3. 缩略图生成时间 < 500ms
4. 内存使用稳定，无明显泄漏

## 测试数据

### 测试关系图
- 名称：测试关系图
- 描述：用于功能测试的关系图
- 节点：至少3个不同类型节点
- 连线：至少2条连线

### 测试人物数据
- 确保人物谱中有测试人物数据
- 人物包含姓名、年龄、性别、介绍等信息

## 问题记录

### 已知问题
- [ ] 问题1：描述
- [ ] 问题2：描述

### 修复状态
- [ ] 问题1：已修复/未修复
- [ ] 问题2：已修复/未修复

## 测试完成确认

- [ ] 所有测试用例已执行
- [ ] 所有功能正常工作
- [ ] 性能要求已满足
- [ ] 文档已更新
- [ ] 代码已提交 